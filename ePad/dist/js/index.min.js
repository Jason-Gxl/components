!function e(t,a,i){function n(s,o){if(!a[s]){if(!t[s]){var c="function"==typeof require&&require;if(!o&&c)return c(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=a[s]={exports:{}};t[s][0].call(u.exports,function(e){var a=t[s][1][e];return n(a||e)},u,u.exports,e,t,a,i)}return a[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,t,a){!function(){"use strict";var e=window.vm||{},t=Object.prototype.toString,a={},i=0,n=[],r=/(\bmobile\b|\bandroid\b)/i.test(navigator.userAgent),s=/\bfirefox\b/i.test(navigator.userAgent),o={click:r?"touchend":"click",down:r?"touchstart":"mousedown",move:r?"touchmove":"mousemove",up:r?"touchend":"mouseup",wheel:s?"DOMMouseScroll":"mousewheel"},c={leftTop:"left-top",rightTop:"right-top",rightBottom:"right-bottom",leftBottom:"left-bottom"},l={layout:"leftTop",size:"100%",vertical:!1,disable:!1,wrap:document.body,autoSaveTime:10,saveImgStep:5,color:"#000",background:"#fff",eraserSize:5,ferulaSize:5,toolbars:r?["pen","line","rectangle","round","text","image","eraser","export","clear"]:["ferula","pen","line","rectangle","round","text","image","eraser","export","clear","color"]},u={rectangle:["rectstroke","rect"],line:["line","arrow"],round:["circle","roundel","ellipesstroke","ellipes"],eraser:["circular","quadrate"]},d={ferula:"教鞭",circle:"空心圆",roundel:"实心圆",ellipesstroke:"空心椭圆",rectstroke:"空心矩形",pen:"画笔",circular:"圆形橡皮擦",quadrate:"方形橡皮擦",rect:"实心矩形",ellipes:"实心椭圆",text:"文本",line:"直线",arrow:"箭头",color:"颜色",export:"导出",scissors:"截图",clear:"清空",image:"图片"},h={ferula:"icon-teach-rod",circle:"icon-round-a",roundel:"icon-round-c",ellipesstroke:"icon-ellipse-b",rectstroke:"icon-rectangle-a",pen:"icon-pen",circular:"icon-xiangpica",quadrate:"icon-rubber",rect:"icon-rectangle-c",ellipes:"icon-ellipse-a",text:"icon-font",line:"icon-line",arrow:"icon-arrow",color:"icon-colour",export:"icon-keep",scissors:"icon-screenshot",clear:"icon-empty",image:"icon-pic"},f={0:"白板",1:"文档演示"},p='\t\t<div class="pad-wrap $LAYOUT$ $DISABLED$">\t\t\t<div class="toolbar-wrap">\t\t\t\t<ul class="toolbar-list">$TOOLBARS$</ul>\t\t\t</div>\t\t\t<div class="can-wrap-outer">\t\t\t\t<div class="can-wrap">\t\t\t\t\t<input type="text" class="text-input tool-input"/>\t\t\t\t\t<canvas class="main-can">抱歉！您的浏览器版本太低，暂时不支持此白板！</canvas>\t\t\t\t\t<canvas class="buffer-can-4"></canvas>\t\t\t\t\t<canvas class="buffer-can-3"></canvas>\t\t\t\t\t<canvas class="buffer-can-2"></canvas>\t\t\t\t\t<canvas class="buffer-can-1"></canvas>\t\t\t\t\t<div class="split-page-wrap"></div>\t\t\t\t</div>\t\t\t\t<div class="scroll-y-wrap pad-hide"><span class="scroll-y scroll-toolbar"></span></div>\t\t\t\t<div class="scroll-x-wrap pad-hide"><span class="scroll-x scroll-toolbar"></span></div>\t\t\t</div>\t\t\t<div class="pad-tab-wrap">\t\t\t\t<ul class="pad-tab-list"></ul>\t\t\t</div>\t\t\t<input type="file" accept="image/png, image/jpeg" class="file-input tool-input"/>\t\t\t<input type="color" class="color-input tool-input"/>\t\t</div>',m='<li class="toolbar-item" title="$TITLE$"><span class="item-icon iconfont $ICONCLASS$" item="$ITEM$" level="$LEVEL$"></span>$CHILDTOOLBARS$</li>',v='<ul class="child-toolbar-list">$CHILDTOOLBARITEM$</ul>',g='\t\t<div>\t\t\t<a href="javascript:void(0);" class="pre-page-btn">上一页</a>\t\t\t<a href="javascript:void(0);" class="next-page-btn">下一页</a>\t\t\t<span>第<input type="text" class="page-number-input"/>页<a href="javascript:void(0);" class="go-page-btn">GO</a></span>\t\t</div>';e.module=e.module||{};var b,w={addEvent:window.addEventListener?function(e,t,a,i){e.addEventListener(t,a,i||!1)}:function(e,t,a){e.attachEvent("on"+t,a)},delEvent:window.addEventListener?function(e,t,a,i){e.removeEventListener(t,a,i||!1)}:function(e,t,a){e.detachEvent("on"+t,a)},addClass:function(e,t){void 0!==e&&void 0!==t&&(new RegExp("\\b"+t+"\\b","g").test(e.className)||(e.className=e.className+" "+t))},removeClass:function(e,t){if(void 0!==e&&void 0!==t){var a=new RegExp("\\b"+t+"\\b","g");a.test(e.className)&&(e.className=e.className.replace(a,""))}},preNode:function(e){return e.previousElementSibling||e.previousSibling},nextNode:function(e){return e.nextElementSibling||e.nextSibling},css:function(e,t,a){e.style[t]=a||""}},y=(b=function(){var e,t=[].slice.call(arguments,0)[0]||window.event,a=b.type,i=b.node,n=i.offsetParent.getBoundingClientRect();0===a?(e=0>(e=(t.x||t.clientX)-b.dValue-(n.x||n.left))?0:e+i.offsetWidth>n.width?n.width-i.offsetWidth:e,i.style.left=e+"px"):(e=0>(e=(t.y||t.clientY)-b.dValue-(n.y||n.top))?0:e+i.offsetHeight>n.height?n.height-i.offsetHeight:e,i.style.top=e+"px");b.callback(e)},{init:function(e,t,a){w.addEvent(e,o.down,function(){var e=[].slice.call(arguments,0)[0]||window.event,i=0===t?e.x||e.clientX:e.y||e.clientY,n=this.getBoundingClientRect();b.type=t,b.node=this,b.callback=a,b.dValue=i-(0===t?n.x||n.left:n.y||n.top),w.addEvent(document,o.move,b),w.addEvent(document,o.up,function(){w.delEvent(document,o.move,b)})})}}),C={get uuid(){for(var e="";e.length<20;e+=Math.random().toString().substr(2));return e.substr(0,20)},scale:function(e){var t=e,a=t.type,i=null,n=null;switch(i&&n||(i=this.mainCanvas.width/t.width,n=this.mainCanvas.height/t.height),a){case"pen":t.data.x=t.data.x*i,t.data.y=t.data.y*n;break;case"text":t.data[0]=t.data[0]*i,t.data[1]=t.data[1]*i;break;case"image":case"file":break;case"eraser":t.data.x=t.data.x*i,t.data.y=t.data.y*n,t.data.size=t.data.size*i;break;default:t.data[0]&&(t.data[0]=isNaN(t.data[0])?t.data[0]:t.data[0]*i),t.data[1]&&(t.data[1]=isNaN(t.data[1])?t.data[1]:t.data[1]*i),t.data[2]&&(t.data[2]=isNaN(t.data[2])?t.data[2]:t.data[2]*i),t.data[3]&&(t.data[3]=isNaN(t.data[3])?t.data[3]:t.data[3]*i)}},copy:function(){var e=[].slice.call(arguments,0),a=e.shift();if(e.length)return"[object Object]"!=(s=t.call(a))&&"[object Array]"!=s?a:(e.forEach(function(e){var i=t.call(e);if("[object Object]"==i||"[object Array]"==i)if("[object Object]"===i){if("[object Array]"===o)var n={};for(var r in e){var s=e[r],o=t.call(s);n?n[r]="[object Object]"===o||"[object Array]"===o?C.copy(s):s:a[r]="[object Object]"===o||"[object Array]"===o?C.copy(s):s}n&&a.push(n)}else e.forEach(function(e,i){var n=t.call(e);"[object Object]"===o?a[i]="[object Object]"===n||"[object Array]"===n?C.copy(s):s:"[object Object]"===n||"[object Array]"===n?a.push(C.copy(s)):a.push(s)})}),a);if("[object Object]"!=(s=t.call(a))&&"[object Array]"!=s)return a;if("[object Object]"===s){var i={};for(var n in a){var r=a[n],s=t.call(r);i[n]="[object Object]"===s||"[object Array]"===s?C.copy(r):r}}else{i=[];a.forEach(function(e){var a=t.call(e);"[object Object]"===a||"[object Array]"===a?i.push(C.copy(e)):i.push(e)})}return i},saveAsImage:function(e,t){for(var a=this,i=0,n=[],r=null,s=e.length,o=a.tab.getActive(),c=a.createImageCanvas,l=function(t){var i=t.shift();if(!i)return function(){var t=c.toDataURL(),i=a.tab.getPage(o.id);c.width=c.width;var s={type:"image",data:[t,0,0],width:0,height:0,status:1,origin:!0,from:"auto"};i&&(s.pageNumber=i.getPageNumber()),r&&e.push(r),e.push(s),[].push.apply(e,n),a.tab.saveData.call(a)}();"file"===i.type?(r=i,l(t)):C.render.call(a,i,function(){l(t)},!0)};s--;){var u=e.pop();if(n.unshift(u),u.origin&&i++,a.params.saveImgStep<=i){c.width=c.width,e.length?l(e):[].push.apply(e,n);break}}},trim:function(e){if(e&&"[object String]"==t.call(e))return e.replace(/^\s*|\s*$/,"")},splitPage:function(e){var a={},i=[],n=[];for(var r in e.forEach(function(e){"[object String]"===t.call(e)?n.push(e):(a[e.pageNumber]=a[e.pageNumber]||[],a[e.pageNumber].push(e))}),a)i.push(r);return i.sort(),i.forEach(function(e){n.push(a[e])}),n},renderPen:function(e,t,a){var i=this,n=a?i.createImageCanvas:0===e.status?i.bufferCanvas:i.mainCanvas,r=e.data,s=i.params.width/e.width,o=i.params.height/e.height,c=n.getContext("2d");0===e.status?n.width=n.width:i.bufferCanvas.width=i.bufferCanvas.width,c.strokeStyle=e.color,c.lineWidth=1,c.save(),c.scale(s,o),r.forEach(function(e,t){0===t?(c.beginPath(),c.moveTo(e.x,e.y)):c.lineTo(e.x,e.y)}),c.stroke(),c.restore(),t&&t()},renderRect:function(e,t,a){var i=this,n=(e.mode,a?i.createImageCanvas:0===e.status?i.bufferCanvas:i.mainCanvas),r=e.data,s=i.params.width/e.width,o=i.params.height/e.height,c=n.getContext("2d");0===e.status?n.width=n.width:i.bufferCanvas.width=i.bufferCanvas.width,c.save(),c.scale(s,o),c.beginPath(),0===e.mode?(c.strokeStyle=e.color,c.lineWidth=1,c.strokeRect(r[0],r[1],r[2],r[3])):(c.fillStyle=e.color,c.fillRect(r[0],r[1],r[2],r[3])),c.restore(),t&&t()},renderLine:function(e,t,a){var i=this,n=e.mode,r=a?i.createImageCanvas:0===e.status?i.bufferCanvas:i.mainCanvas,s=e.data,o=i.params.width/e.width,c=i.params.height/e.height,l=r.getContext("2d");if(0===e.status?r.width=r.width:i.bufferCanvas.width=i.bufferCanvas.width,l.strokeStyle=e.color,l.lineWidth=1,l.save(),l.scale(o,c),l.beginPath(),l.moveTo(s[0],s[1]),l.lineTo(s[2],s[3]),1===n){var u=180*Math.atan2(s[1]-s[3],s[0]-s[2])/Math.PI,d=(u+30)*Math.PI/180,h=(u-30)*Math.PI/180,f=15*Math.cos(d),p=15*Math.sin(d),m=15*Math.cos(h),v=15*Math.sin(h);l.moveTo(f+s[2],p+s[3]),l.lineTo(s[2],s[3]),l.moveTo(m+s[2],v+s[3]),l.lineTo(s[2],s[3])}l.stroke(),l.restore(),t&&t()},renderRound:function(e,t,a){var i=this,n=e.mode,r=a?i.createImageCanvas:0===e.status?i.bufferCanvas:i.mainCanvas,s=e.data,o=i.params.width/e.width,c=i.params.height/e.height,l=r.getContext("2d");switch(0===e.status?r.width=r.width:i.bufferCanvas.width=i.bufferCanvas.width,l.save(),l.scale(o,c),l.beginPath(),n){case 0:l.strokeStyle=e.color,l.lineWidth=1,l.arc(s[0],s[1],s[2],0,2*Math.PI),l.stroke();break;case 1:l.fillStyle=e.color,l.arc(s[0],s[1],s[2],0,2*Math.PI),l.fill();break;case 2:l.strokeStyle=e.color,l.lineWidth=1;var u=s[2]>s[3]?s[2]:s[3],d=s[2]/u,h=s[3]/u;l.scale(d,h),l.arc(s[0]/d,s[1]/h,u,0,2*Math.PI),l.closePath(),l.stroke();break;case 3:l.fillStyle=e.color;u=s[2]>s[3]?s[2]:s[3],d=s[2]/u,h=s[3]/u;l.scale(d,h),l.arc(s[0]/d,s[1]/h,u,0,2*Math.PI),l.closePath(),l.fill()}l.restore(),t&&t()},renderText:function(e,t,a){var i=this,n=a?i.createImageCanvas:0===e.status?i.bufferCanvas:i.mainCanvas,r=e.data,s=i.params.width/e.width,o=i.params.height/e.height,c=n.getContext("2d");0===e.status?n.width=n.width:i.bufferCanvas.width=i.bufferCanvas.width,c.fillStyle=e.color,c.save(),c.scale(s,o),c.beginPath(),c.fillText(r[2],r[0],r[1]),c.restore(),t&&t()},renderImage:function(e,t,a){var i=a?this.createImageCanvas:0===e.status?this.bufferCanvas:this.mainCanvas,n=e.data,r=new Image,s=i.getContext("2d");r.src=n[0];var o=i.clientWidth,c=i.clientHeight;r.onload=function(){var a=r.width,i=r.height,l=o-a,u=c-i;if(s.save(),l>=0&&u>=0){var d=l/2,h=u/2;s.drawImage(r,l/2,u/2),e.fileWidth=a,e.fileHeight=i,n[1]=d,n[2]=h}else{var f=o/c,p=r.width/r.height;f>p?(s.drawImage(r,(o-c*p)/2,0,c*p,c),e.fileWidth=c*p,e.fileHeight=c,n[1]=(o-c*p)/2,n[2]=0):(s.drawImage(r,0,(c-o/p)/2,o,o/p),e.fileWidth=o,e.fileHeight=o/p,n[1]=0,n[2]=(c-o/p)/2)}s.restore(),t&&t()}},delete:function(e,t,a){var i=this,n=a?i.createImageCanvas:0===e.status?i.bufferCanvas:i.mainCanvas,r=e.data,s=i.params.width/e.width,o=i.params.height/e.height,c=s<o?s:o,l=n.getContext("2d");0===e.status?n.width=n.width:i.bufferCanvas.width=i.bufferCanvas.width,l.strokeStyle=i.params.background,l.fillStyle=i.params.background,0===e.mode?(l.lineJoin="round",l.lineCap="round"):(l.lineCap="square",l.lineJoin="bevel"),l.save(),l.scale(c,c),r.forEach(function(e,t){l.lineWidth=e.size,0===t&&(l.beginPath(),l.moveTo(e.x,e.y)),l.lineTo(e.x,e.y)}),l.stroke(),l.restore(),t&&t()},render:function(e,t,a){var i=this;switch(e.type){case"pen":C.renderPen.call(i,e,t,a);break;case"rectangle":C.renderRect.call(i,e,t,a);break;case"line":C.renderLine.call(i,e,t,a);break;case"round":C.renderRound.call(i,e,t,a);break;case"text":C.renderText.call(i,e,t,a);break;case"image":case"file":C.renderImage.call(i,e,t,a);break;case"eraser":C.delete.call(i,e,t,a)}}},E={eraser:function(e){var t=this.mouseIconCanvas,a=e.data,i=e.mode,n=this.params.width/e.width,r=this.params.height/e.height,s=n<r?n:r,o=t.getContext("2d");if(t.width=t.width,o.scale(s,s),o.beginPath(),0===i)o.arc(a[0],a[1],a[2]/2,0,2*Math.PI),o.stroke();else{var c=a[0]-a[2]/2,l=a[1]-a[2]/2;o.rect(c,l,a[2],a[2]),o.stroke()}},ferula:function(e){var t=this.mouseIconCanvas,a=e.data,i=this.params.ferulaSize,n=this.params.width/e.width,r=this.params.height/e.height,s=n<r?n:r,o=t.getContext("2d");t.width=t.width,o.scale(s,s),o.beginPath(),o.fillStyle="red",o.arc(a[0],a[1],i,0,2*Math.PI),o.fill()},render:function(e){var t=e.type;E[t]&&E[t].call(this,e)}},x=function(){var e=document.createElement("UL"),t='<li class="pad-tab-item">$LABEL$$DELETEBTN$</li>',a='<i class="iconfont icon-close"></i>';function i(i){var n=this,r={},s={},c={},l={},u=[],d=!1,h={},p=i.getElementsByClassName("pad-tab-list")[0];n.build=function(i,d,h,m,v){if(i){var g=this,b=m||(0===d?0:C.uuid),y=t.replace(/\$LABEL\$/g,f[d]).replace(/\$DELETEBTN\$/g,v?a:"");e.innerHTML=y,u.push(b);var E=e.firstElementChild||e.firstChild;return r[b]=E,s[b]=h||[],c[b]=i,v&&w.addEvent(E.getElementsByTagName("i")[0],o.click,function(){var e=[].slice.call(arguments,0)[0]||window.event;window.event?(e.returnValue=!1,e.cancelBubble=!0):(e.preventDefault(),e.stopPropagation()),n.remove.call(g,b),g.params.onTabRemove&&g.params.onTabRemove(b)}),w.addEvent(E,o.click,function(){this!==l.tab&&(g.params.onTabChange&&g.params.onTabChange(b),n.active.call(g,b))}),p.appendChild(E),g.container[b]={data:s[b],type:d,splitPage:0,del:v},b}},n.push=function(e,t){var a=this,i=0;s[e]||(s[e]=[]),s[e].push(t),a.tab.saveData.call(a),s[e].forEach(function(e){"auto"!=e.from&&i++}),i-a.params.saveImgStep>=a.params.saveImgStep&&C.saveAsImage.call(a,s[e],a.container[e].type)},n.saveData=function(){var e=this;if(!d&&"never"!==e.params.autoSaveTime){e.params.autoSaveTime=isNaN(e.params.autoSaveTime)?10:+e.params.autoSaveTime;var t=setTimeout(function(){for(var a in h){var i=h[a];s[a].length=0,[].push.apply(s[a],i.getData())}window.localStorage.setItem(e.id+"_pad",JSON.stringify(e.container)),clearTimeout(t),d=!1},1e3*e.params.autoSaveTime);d=!0}},n.remove=function(e){var t=this,a=r[e],i=u.indexOf(e);delete r[e],delete s[e],delete c[e],delete t.container[e],h[e]&&(h[e].hide(),delete h[e]),p.removeChild(a),u.splice(i,1),e=u[i-1>=0?i-1:0],t.tab.active.call(t,e),window.localStorage.setItem(t.id+"_pad",JSON.stringify(t.container))},n.active=function(e){var t=this,a=s[e];if(l.canvas&&(w.css(l.canvas,"zIndex"),w.removeClass(l.tab,"active")),l.page&&(l.page.hide(),delete l.page),l.tab=r[e],l.data=s[e],l.canvas=c[e],l.id=e,l.type=t.container[e].type,l.page=h[e],t.mainCanvas=l.canvas,w.css(l.canvas,"zIndex",2),w.addClass(l.tab,"active"),l.page&&l.page.show(),a&&!l.page){l.canvas.width=l.canvas.width;var i=0,n=a.length;if(n){var o=function(){var e=a[i];e&&C.render.call(t,e,function(){++i<n&&o()})};o()}}},n.getActive=function(){return l},n.getTab=function(e){return r[e]},n.clear=function(e){void 0===e?(l.data.length=0,this.container[l.id].splitPage=0,l.canvas.width=l.canvas.width,l.page&&(l.page.hide(),delete h[l.id],delete l.page)):(s[e].length=0,this.container[e].splitPage=0,c[e].width=c[e].width,h[e]&&(h[e].hide(),delete h[e])),window.localStorage.setItem(this.id+"_pad",JSON.stringify(this.container))},n.setPage=function(e,t){h[e]=t,this.container[e].splitPage=1},n.getPage=function(e){return h[e]}}return i.prototype={constructor:i},i}();function B(e){if(!this instanceof B)return new B(e);var a=this,i=1,n=e.that,r=C.splitPage(e.data),s=r.length,c=e.tabId,l=e.show||!1,u=document.createElement("DIV"),d=n.params.wrap.getElementsByClassName("split-page-wrap")[0];u.innerHTML=g;var h=u.removeChild(u.firstElementChild||u.firstChild),f=h.getElementsByClassName("pre-page-btn")[0],p=h.getElementsByClassName("next-page-btn")[0],m=h.getElementsByClassName("go-page-btn")[0],v=h.getElementsByClassName("page-number-input")[0];w.addEvent(f,o.click,function(){n.params.disable||i<=1||a.pre()}),w.addEvent(p,o.click,function(){n.params.disable||i>=s||a.next()}),w.addEvent(m,o.click,function(){if(!n.params.disable){var e=v.value;a.go(e)}}),this.pre=function(){i--,this.go(i)};var b=function(e,a,i){var s=r[e-1];"[object Array]"===t.call(s)?s.some(function(t,r){if(!(r<a)){var o=!1;return"file"===t.type?(o=!0,C.render.call(n,t,function(){s.length-1<=r?i&&i():b(e,++r,i)})):(C.render.call(n,t),s.length-1<=r&&i&&i()),o}}):C.render.call(n,s,i)};this.go=function(e,t){switch(e=(e=e<=1?1:e)>=s?s:e,n.mainCanvas.width=n.mainCanvas.width,b(e,0,function(){!t&&n.params.onPageTurn&&n.params.onPageTurn(c,e,r[e-1][0])}),i=e,v.value=e,!0){case i<=1&&i<s:w.addClass(f,"no"),w.removeClass(p,"no");break;case i>1&&i>=s:w.removeClass(f,"no"),w.addClass(p,"no");break;default:w.removeClass(f,"no"),w.removeClass(p,"no")}},this.next=function(){i++,this.go(i)},this.show=function(){d.innerHTML="",r.length>1&&d.appendChild(h),n.page=a,this.go(i)},this.hide=function(){n.page==a&&(r.length>1&&d.removeChild(h),delete n.page)},this.getPageNumber=function(){return i},this.empower=function(){v.removeAttribute("readonly")},this.disable=function(){v.setAttribute("readonly","readonly")},r.forEach(function(a,i){"[object String]"===t.call(a)&&(r[i]=[{data:[a,0,0],pageNumber:i+1,width:n.params.width,height:n.params.height,status:1,type:"file",from:e.from}])}),this.push=function(e){var t=n.tab.getActive(),a=0;e.pageNumber=i,r[i-1].push(e),n.tab.saveData.call(n),r[i-1].forEach(function(e){"file"!=e.type&&"auto"!=e.from&&a++}),a-n.params.saveImgStep>=n.params.saveImgStep&&C.saveAsImage.call(n,r[i-1],n.container[t.id].type)},this.getData=function(){for(var e=0,t=[];e<s;)[].push.apply(t,r[e]),e++;return t},n.params.disable&&this.disable(),n.tab.saveData.call(n),l&&(d.innerHTML="",r.length>1&&d.appendChild(h),a.go(1))}function T(a){if(!this instanceof T)return new T(a);var n={pad:this,params:a,waitList:[],container:{},id:a.id||i++,render:function(e){if(C.render.call(n,e,function(){if(a.onRender){var t=C.copy(e),i={},r=n.tab.getActive();i[r.id]={data:t,type:r.type,splitPage:r.page?1:0},a.onRender(i)}}),e.width=n.mainCanvas.width,e.height=n.mainCanvas.height,e.status){var t=n.tab.getActive();t.page?t.page.push.call(n,e):n.tab.push.call(n,t.id,e)}},mouseRender:function(e){if(E.render.call(n,e),e.width=n.mainCanvas.width,e.height=n.mainCanvas.height,a.onMousemove){var t=C.copy(e),i={},r=n.tab.getActive();i[r.id]={data:t,type:r.type},a.onMousemove(i)}}};(function(){var a=this,i=this.params,n=i.wrap,s=i.toolbars,l={},f=!1,g=null,b=null,E=null,T=new FileReader,I=!1,N=null,S=null,k=null,A=null,$="",j=null,L=null,P=null,R=null,M=null,O=null,D=null,H=null;s.forEach(function(t){var a=u[t];switch(t){case"handPad":case"color":case"clear":case"export":break;default:a?a.forEach(function(a){l[a]=new e.module[t]({name:a})}):l[t]=new e.module[t]({name:t})}var i=m.replace(/\$ITEM\$/g,a?a[0]:t).replace(/\$ICONCLASS\$/g,a?h[a[0]]:h[t]).replace(/\$TITLE\$/g,a?d[a[0]]:d[t]).replace(/\$LEVEL\$/g,0);if(i=i.replace(/\$CHILDTOOLBARS\$/g,a?v:""),a){var n="";a.forEach(function(e){n+=m.replace(/\$ITEM\$/g,e).replace(/\$ICONCLASS\$/g,h[e]).replace(/\$TITLE\$/g,d[e]).replace(/\$CHILDTOOLBARS\$/g,"").replace(/\$LEVEL\$/g,1)}),i=i.replace(/\$CHILDTOOLBARITEM\$/g,n)}$+=i});var z=p.replace(/\$LAYOUT\$/g,c[i.layout]+(i.vertical?" vertical":"")).replace(/\$TOOLBARS\$/g,$).replace(/\$DISABLED\$/g,i.disable?"disabled":""),W=i.data||JSON.parse(window.localStorage.getItem(a.id+"_pad"));n.innerHTML=z,this.toolbarMap=l;var V=n.getElementsByClassName("can-wrap")[0],q=n.getElementsByClassName("toolbar-list")[0];j=n.getElementsByClassName("color-input")[0],L=n.getElementsByClassName("file-input")[0],P=n.getElementsByClassName("text-input")[0],R=n.getElementsByClassName("main-can")[0],S=n.getElementsByClassName("scroll-x-wrap")[0],N=n.getElementsByClassName("scroll-y-wrap")[0],A=S.getElementsByClassName("scroll-x")[0],k=N.getElementsByClassName("scroll-y")[0],M=n.getElementsByClassName("buffer-can-1")[0],O=n.getElementsByClassName("buffer-can-2")[0],D=n.getElementsByClassName("buffer-can-3")[0],H=n.getElementsByClassName("buffer-can-4")[0];var U=null,Y=!1;if(i.size&&/\*/.test(i.size)){var J=i.size.split(/\*/);if(Y=!0,2!=J.length)var X=V.clientWidth,_=V.clientHeight;else var X=isNaN(J[0])?V.clientWidth:J[0],_=isNaN(J[1])?V.clientHeight:J[1];w.addEvent(V,o.wheel,function(){var e=[].slice.call(arguments,0),t=e[0]||window.event;V.scrollTop=V.scrollTop+("DOMMouseScroll"===t.type?3===t.detail?100:-100:t.deltaY),k.style.top=(N.clientHeight-k.offsetHeight)*(V.scrollTop/(V.scrollHeight-V.clientHeight))+"px",window.event?(t.returnValue=!1,t.cancelBubble=!0):(t.preventDefault(),t.stopPropagation())}),y.init(A,0,function(e){var t=S.getBoundingClientRect(),a=t.width-A.offsetWidth,i=V.scrollWidth-V.offsetWidth;V.scrollLeft=e*(i/a)}),y.init(k,1,function(e){var t=N.getBoundingClientRect(),a=t.height-k.offsetHeight,i=V.scrollHeight-V.offsetHeight;V.scrollTop=e*(i/a)}),U=function(){var e=V.clientWidth,t=V.clientHeight;if(e<i.width){w.removeClass(S,"pad-hide");var a=e-(i.width-e);a=a<10?10:a,A.style.width=a+"px"}else w.addClass(S,"pad-hide");if(t<i.height){w.removeClass(N,"pad-hide");var n=t-(i.height-t);n=n<10?10:n,k.style.height=n+"px"}else w.addClass(N,"pad-hide")}}else{var X=V.clientWidth,_=V.clientHeight;U=function(){var e=V.clientWidth,t=V.clientHeight;e==i.width&&t==i.height||(i.width=e,i.height=t,R.width=e,R.height=t,M.width=e,M.height=t,O.width=e,O.height=t,D.width=e,D.height=t,H.width=e,H.height=t,a.tab.active.call(a,a.tab.getActive().id))}}if(R.width=X,R.height=_,M.width=X,M.height=_,O.width=X,O.height=_,D.width=X,D.height=_,H.width=X,H.height=_,i.width=X,i.height=_,Y&&U(),w.addEvent(window,"resize",function(){U()}),a.tab=new x(i.wrap),a.textInput=P,a.mouseIconCanvas=M,a.createImageCanvas=D,a.fileCanvas=H,w.css(R,"background",a.params.background),w.css(H,"background",a.params.background),w.addEvent(j,"change",function(){a.params.color=this.value}),a.pad.showFiles=function(e){var i=e.files,n=e.newTab,r=e.isShow,s=e.from,o=e.tabId,c=(e.tabName,a.tab.getActive());i="[object Array]"===t.call(i)?i:[i];var l=function(){a.pad.clear();var e=new B({data:i,show:r,that:a,tabId:n?u:c.id});a.tab.setPage.call(a,void 0!=u?u:c.id,e),c.page=e};if(n){var u=a.tab.build.call(a,H,1,null,o,s===a.params.id);e.tabId=u,r&&(a.tab.active.call(a,u),l(),a.params.onTabChange&&a.params.onTabChange(u))}else l()},T.onload=function(e){a.toolbarMap.image.renderBuffer.call(a,e.target.result),a.toolbarMap.image.render.call(a,[0,0]),L.value=""},w.addEvent(L,"change",function(){T.readAsDataURL(this.files[0])}),w.addEvent(P,"keyup",function(){if(13===([].slice.call(arguments,0)[0]||window.event).which){var e=C.trim(this.value);g.render.call(a,e)}}),w.addEvent(document,"keydown",function(){var e=[].slice.call(arguments,0)[0]||window.event,t=e.which;if(a.active)switch(!0){case 107===t||187===t&&e.shiftKey:g&&g.largen&&g.largen.call(a);break;case 109===t||189===t&&e.shiftKey:g&&g.lesser&&g.lesser.call(a)}}),w.addEvent(q,o.click,function(){if(!i.disable){var e=[].slice.call(arguments,0)[0]||window.event,n=e.srcElement||e.target,r=+n.getAttribute("level"),s=n.getAttribute("item");if(s){switch(s){case"handPad":(f=!f)?n.setAttribute("active",""):n.removeAttribute("active");break;case"color":j.click();break;case"clear":a.tab.clear.call(a),i.onClear&&"[object Function]"===t.call(i.onClear)&&i.onClear(a.tab.getActive().id);break;case"export":var o=a.mainCanvas.toDataURL().replace(/image\/png/,"image/octet-stream;Content-Disposition:attachment;filename="+C.uuid+".png");location.href=o;break;case"image":L.click();break;default:if(!(g=l[s]||g))return;if(a.current=g,g.active(),0===r){b&&b.removeAttribute("active"),b=n;var c=q.getElementsByClassName("selected-item")[0];n.parentNode!=c&&w.removeClass(c,"selected-item"),w.addClass(n.parentNode,"selected-item")}if(1===r){E&&E.removeAttribute("active");var u=w.preNode(n.parentNode.parentNode);u.title=n.parentNode.title,u.className=u.className.replace(/\bicon-[\w-]+\b/,n.className.match(/\bicon-[\w-]+\b/)),E=n}n.setAttribute("active","")}s&&(window.event?(e.returnValue=!1,e.cancelBubble=!0):(e.preventDefault(),e.stopPropagation()))}}}),w.addEvent(q,"mousedown",function(){var e=[].slice.call(arguments,0)[0]||window.event;window.event?(e.returnValue=!1,e.cancelBubble=!0):(e.preventDefault(),e.stopPropagation())}),w.addEvent(M,o.move,function(){if(g){var e=[].slice.call(arguments,0)[0]||window.event,t=this.getBoundingClientRect(),i=g.name.toLowerCase(),n={x:(r?e.targetTouches[0].clientX:e.clientX)-(t.x||t.left),y:(r?e.targetTouches[0].clientY:e.clientY)-(t.y||t.top)};if(f||I)switch(i){case"ferula":g.mouseRender.call(a,n);break;case"circular":case"quadrate":g.mouseRender.call(a,n);default:g.bufferRender.call(a,n)}else g.mouseRender&&g.mouseRender.call(a,n);window.event?(e.returnValue=!1,e.cancelBubble=!0):(e.preventDefault(),e.stopPropagation())}}),w.addEvent(M,o.down,function(){var e=[].slice.call(arguments,0),t=this.getBoundingClientRect(),i=q.getElementsByClassName("selected-item")[0],n=e[0]||window.event,s={x:(r?n.targetTouches[0].clientX:n.clientX)-(t.x||t.left),y:(r?n.targetTouches[0].clientY:n.clientY)-(t.y||t.top)};I=!0,w.removeClass(i,"selected-item"),g&&g.bufferRender&&g.bufferRender.call(a,s,!0),window.event?(n.returnValue=!1,n.cancelBubble=!0):(n.preventDefault(),n.stopPropagation())}),w.addEvent(document,o.down,function(){var e=q.getElementsByClassName("selected-item")[0];w.removeClass(e,"selected-item"),a.textInput.removeAttribute("style")}),w.addEvent(document,"mouseup",function(){I&&(I=!1,g&&g.render&&g.render.call(a))}),w.addEvent(M,o.up,function(){[].slice.call(arguments,0)[0]||window.event,I=!1,g&&g.render&&g.render.call(a)}),w.addEvent(V,"mouseleave",function(){M.width=M.width}),a.bufferCanvas=O,W)for(var F in W){var K=W[F],G=a.tab.build.call(a,0===K.type?R:H,K.type,K.data,F,K.del);if(K.splitPage){var Q=new B({data:K.data,show:0===K.type,that:a,tabId:G});a.tab.setPage.call(a,G,Q)}0===K.type&&a.tab.active.call(a,G)}else{var G=a.tab.build.call(a,R,0);a.tab.active.call(a,G)}}).call(n);var s=function(e){var t=n.tab.getActive();for(var a in e){(i=e[a]).type;var i=i.data;if(a==t.id)C.render.call(n,i),i.status&&(t.page?t.page.push.call(n,i):n.tab.push.call(n,a,i));else if(n.tab.getTab(a)){if(i.status){var r=n.tab.getPage(a);r?r.push.call(n,i,a):n.tab.push.call(n,a,i)}}else n.tab.build.call(n,n.fileCanvas,1,[i],a,!1)}};this.render=function(e){"[object Object]"==t.call(e)?s(e):console.error("TypeError: data must be Object")},this.renderAll=function(e){"[object Object]"==t.call(e)?e.forEach(function(e){s(e)}):console.error("TypeError: data must be Array")},this.mouseCtrl=function(e){"[object Object]"==t.call(e)?function(e){for(var t in e){(a=e[t]).type;var a=a.data;E.render.call(n,a)}}(e):console.error("TypeError: data must be Object")},this.clear=function(e){n.tab.clear.call(n,e)},this.disable=function(){w.addClass(a.wrap.firstElementChild||a.wrap.firstChild,"disabled"),a.disable=!0},this.enable=function(){w.removeClass(a.wrap.firstElementChild||a.wrap.firstChild,"disabled"),a.disable=!1},this.createImage=function(){return n.mainCanvas.toDataURL()},this.changeTab=function(e){n.tab.active.call(n,e)},this.turnPage=function(e,t){e===n.tab.getActive().id&&n.tab.getPage.call(n,e).go(t,!0)},this.removeTab=function(e){void 0!==e&&n.tab.remove.call(n,e)},w.addEvent(a.wrap,"mouseenter",function(){n.active=!0}),w.addEvent(a.wrap,"mouseleave",function(){n.active=!1})}B.prototype={constructor:B},window.wPad={init:function(e){var t=C.copy({},l),i=new T(t=C.copy(t,e));return void 0!=t.id&&(a[t.id]=i),n.push(i),i},getPadById:function(e){if(void 0!==e)return a[e]},getPadByIndex:function(e){if(void 0!==e)return n[e]}}}()},{}],2:[function(e,t,a){!function(){"use strict";var e={circular:0,quadrate:1},t=null;function a(e){this.name=e.name||"Eraser",this.interimBuffer=[],this.buffer=[]}a.prototype={constructor:a,active:function(){},mouseRender:function(a){var i=this;a={type:"eraser",data:[a.x,a.y,i.params.eraserSize],mode:e[i.current.name],from:i.params.id},t=a,i.mouseRender.call(i,a)},largen:function(){var e=this,a=e.params.eraserSize,i=e.mainCanvas.clientWidth,n=e.mainCanvas.clientHeight;a++,e.params.eraserSize=Math.min.apply(Math,[a,i,n]),t.data[2]=e.params.eraserSize,e.mouseRender.call(e,t)},lesser:function(){var e=this,a=e.params.eraserSize;a--,e.params.eraserSize=Math.max.apply(Math,[5,a]),t.data[2]=e.params.eraserSize,e.mouseRender.call(e,t)},bufferRender:function(t,a){if(t){var i=this,n=a?{type:"eraser",data:[],status:0,origin:!!a,mode:e[i.current.name],from:i.params.id,width:i.params.width,height:i.params.height}:i.current.interimBuffer.pop();t.size=i.params.eraserSize,n.data.push(t),i.current.interimBuffer.push(n),i.render(n)}},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)}};var i=window.vm||{};i.module=i.module||{},i.module.eraser=a,window.vm=i}()},{}],3:[function(e,t,a){!function(){"use strict";function e(e){this.name=e.name||"Ferula",this.buffer=[]}e.prototype={constructor:e,active:function(){},mouseRender:function(e){e={type:"ferula",data:[e.x,e.y],from:this.params.id},e,this.mouseRender.call(this,e)}};var t=window.vm||{};t.module=t.module||{},t.module.ferula=e,window.vm=t}()},{}],4:[function(e,t,a){!function(){"use strict";function e(e){this.name=e.name||"Image",this.interimBuffer=[],this.buffer=[]}e.prototype={constructor:e,active:function(){},renderBuffer:function(e){e={type:"image",data:[e],status:0,origin:!0,from:this.params.id,width:this.params.width,height:this.params.height};this.toolbarMap.image.interimBuffer.push(e)},render:function(e){if(e){var t=this.toolbarMap.image.interimBuffer.shift();if(t)do{t.status=1,t.data=[].concat.apply(t.data,e),this.toolbarMap.image.buffer.push(t),this.render(t),t=this.toolbarMap.image.interimBuffer.shift()}while(t)}}};var t=window.vm||{};t.module=t.module||{},t.module.image=e,window.vm=t}()},{}],5:[function(e,t,a){!function(){"use strict";var e={line:0,arrow:1};function t(e){this.name=e.name||"Line",this.interimBuffer=[],this.points=[],this.buffer=[]}t.prototype={constructor:t,active:function(){},bufferRender:function(t,a){var i=this;a?(i.current.points=[],i.current.points.push(t.x),i.current.points.push(t.y)):(i.current.points[2]=t.x,i.current.points[3]=t.y),a||(i.current.interimBuffer.pop(),t={type:"line",data:t=[].concat.apply([],i.current.points),status:0,mode:e[i.current.name],origin:!0,color:i.params.color,from:i.params.id,width:i.params.width,height:i.params.height},i.current.interimBuffer.push(t),i.render(t))},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)}};var a=window.vm||{};a.module=a.module||{},a.module.line=t,window.vm=a}()},{}],6:[function(e,t,a){!function(){"use strict";function e(e){this.name=e.name||"Pen",this.interimBuffer=[],this.buffer=[]}e.prototype={constructor:e,active:function(){},bufferRender:function(e,t){var a=this,i=t?{type:"pen",data:[],status:0,origin:!!t,color:a.params.color,from:a.params.id,width:a.params.width,height:a.params.height}:a.current.interimBuffer.pop();i.data.push(e),a.current.interimBuffer.push(i),a.render(i)},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)}};var t=window.vm||{};t.module=t.module||{},t.module.pen=e,window.vm=t}()},{}],7:[function(e,t,a){!function(){"use strict";var e={rectstroke:0,rect:1};function t(e){this.name=e.name||"Rectangle",this.interimBuffer=[],this.points=[],this.buffer=[]}t.prototype={constructor:t,active:function(){},bufferRender:function(t,a){var i=this;a?(i.current.points=[],i.current.points.push(t.x),i.current.points.push(t.y)):(i.current.points[2]=t.x-(i.current.points[0]||0),i.current.points[3]=t.y-(i.current.points[1]||0),i.current.interimBuffer.pop(),t={type:"rectangle",data:t=[].concat.apply([],i.current.points),status:0,mode:e[i.current.name],origin:!0,color:i.params.color,from:i.params.id,width:i.params.width,height:i.params.height},i.current.interimBuffer.push(t),i.render(t))},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)}};var a=window.vm||{};a.module=a.module||{},a.module.rectangle=t,window.vm=a}()},{}],8:[function(e,t,a){!function(){"use strict";var e={circle:0,roundel:1,ellipesstroke:2,ellipes:3};function t(e){this.name=e.name||"Round",this.interimBuffer=[],this.points=[],this.buffer=[]}t.prototype={constructor:t,active:function(){},bufferRender:function(t,a){var i=this;if(a)i.current.points=[],i.current.points.push(t.x),i.current.points.push(t.y);else{var n=[],r=i.current.points[0],s=i.current.points[1],o=e[i.current.name],c=t.x-r,l=t.y-s;n.push((r+t.x)/2),n.push((s+t.y)/2),0===o||1===o?n.push(Math.abs(c)>Math.abs(l)?Math.abs(c)/2:Math.abs(l)/2):(n.push(Math.abs(c)/2),n.push(Math.abs(l)/2)),i.current.interimBuffer.pop(),t={type:"round",data:n,status:0,mode:o,origin:!0,color:i.params.color,from:i.params.id,width:i.params.width,height:i.params.height},i.current.interimBuffer.push(t),i.render(t)}},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)}};var a=window.vm||{};a.module=a.module||{},a.module.round=t,window.vm=a}()},{}],9:[function(e,t,a){!function(){"use strict";function e(e){this.name=e.name||"Text",this.interimBuffer=[],this.points=[],this.buffer=[]}e.prototype={constructor:e,active:function(){},bufferRender:function(e,t){var a=this;t&&(a.current.points=[],a.current.points.push(e.x),a.current.points.push(e.y),a.textInput.style.cssText="visibility: visible; z-index: 101; left: "+e.x+"px; top: "+(e.y-a.textInput.offsetHeight/2)+"px",a.textInput.focus(),e={type:"text",data:[e.x,e.y],status:0,origin:!!t,color:a.params.color,from:a.params.id,width:a.params.width,height:a.params.height},a.current.interimBuffer.push(e))},render:function(e){if("[object String]"==Object.prototype.toString.call(e)&&(e=e.replace(/^\s*|\s*$/,""))){var t=this,a=t.current.interimBuffer.pop();a&&(a.data.push(e),t.textInput.value="",t.textInput.removeAttribute("style"),a.status=1,t.current.buffer.push(a),t.render(a),t.current.interimBuffer.length=0)}}};var t=window.vm||{};t.module=t.module||{},t.module.text=e,window.vm=t}()},{}]},{},[2,3,4,5,6,7,8,9,1]);
//# sourceMappingURL=index.min.js.map
